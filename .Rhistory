#screeningFrame is included in global
screeningGraph(data = screeningFrame,
globalCovariate = input$globalCovariate,
selCovariate = input$selCovariate)
})
}
output$ByVisitGraph = renderPlotly({
graphFrame = selectedData() %>%
filter(AVISIT != "SCREENING")
ggplotly(
ggplot(data = graphFrame, aes_string(x = "AVISIT",
y = input$LabMeasurement,
colour = "ACTARM")
) + geom_boxplot()
) %>% layout(boxmode = "group")
})
screeningFrame = TrialFrame %>% filter(daysFromBaseline == -1)
screeningFrame$age
#need to find out how to not have it in alphabetical order
p <- ggplot(data = screeningFrame, aes(x = age, colour = treatmentArm)) +
geom_density() + geom_density(aes(x = age, colour = "Overall"))
p
p <- ggplot(data = screeningFrame, aes(x = treatmentArm,fill = sex)) +
geom_bar(position = 'fill')  + geom_bar(aes(x = "Overall",fill = sex),position='fill')
pp
screeningGraph = function(data,globalCovariate,selCovariate,graphType){
if(class(data[[selCovariate]]) == 'numeric'){
if(globalCovariate == "Yes"){
p <- ggplot(data = data, aes_string(x = selCovariate, colour = "treatmentArm")) +
geom_density() +
geom_density(aes_string(x = selCovariate, colour = "Overall"))
}else if(globalCovariate == "No"){
p <- ggplot(data = data, aes_string(x = selCovariate, colour = "treatmentArm")) +
geom_density()
}
}else if(class(data[[selCovariate]]) == 'factor'){
if(globalCovariate == "Yes"){
p <- ggplot(data = data, aes_string(x = "treatmentArm",fill = selCovariate)) +
geom_bar(position = 'fill')  +
geom_bar(aes_string(x = "Overall",fill = selCovariate),position='fill')
}else if(globalCovariate == "No"){
p <- ggplot(data = data, aes_string(x = "treatmentArm",fill = selCovariate)) +
geom_bar(position = 'fill')
}
}
return(p)
}
screeningGraph(data = screeningFrame,globalCovariate = "No",selCovariate = "age")
screeningGraph = function(data,globalCovariate,selCovariate,graphType){
if(class(data[[selCovariate]]) == 'numeric'){
if(globalCovariate == "Yes"){
p <- ggplot(data = data, aes_string(x = selCovariate, colour = "treatmentArm")) +
geom_density() +
geom_density(aes_string(x = selCovariate, colour = "Overall"))
}else if(globalCovariate == "No"){
p <- ggplot(data = data, aes_string(x = selCovariate, colour = "treatmentArm")) +
geom_density()
}
}else if(class(data[[selCovariate]]) == 'factor'){
if(globalCovariate == "Yes"){
p <- ggplot(data = data, aes_string(x = "treatmentArm",fill = selCovariate)) +
geom_bar(position = 'fill')  +
geom_bar(aes_string(x = "Overall",fill = selCovariate),position='fill')
}else if(globalCovariate == "No"){
p <- ggplot(data = data, aes_string(x = "treatmentArm",fill = selCovariate)) +
geom_bar(position = 'fill')
}
}
return(p)
}
screeningGraph(data = screeningFrame,globalCovariate = "No",selCovariate = "age")
screeningGraph(data = screeningFrame,globalCovariate = "Yes",selCovariate = "age")
screeningGraph(data = screeningFrame,globalCovariate = "No",selCovariate = "age")
selCovariate = 'age'
ggplot(data = data, aes_string(x = selCovariate, colour = "treatmentArm")) +
geom_density()
ggplot(data = screeningFrame, aes_string(x = selCovariate, colour = "treatmentArm")) +
geom_density()
data
screeningGraph = function(screeningData,globalCovariate,selCovariate,graphType){
if(class(screeningData[[selCovariate]]) == 'numeric'){
if(globalCovariate == "Yes"){
p <- ggplot(data = screeningData, aes_string(x = selCovariate, colour = "treatmentArm")) +
geom_density() +
geom_density(aes_string(x = selCovariate, colour = "Overall"))
}else if(globalCovariate == "No"){
p <- ggplot(data = screeningData, aes_string(x = selCovariate, colour = "treatmentArm")) +
geom_density()
}
}else if(class(screeningData[[selCovariate]]) == 'factor'){
if(globalCovariate == "Yes"){
p <- ggplot(data = screeningData, aes_string(x = "treatmentArm",fill = selCovariate)) +
geom_bar(position = 'fill')  +
geom_bar(aes_string(x = "Overall",fill = selCovariate),position='fill')
}else if(globalCovariate == "No"){
p <- ggplot(data = screeningData, aes_string(x = "treatmentArm",fill = selCovariate)) +
geom_bar(position = 'fill')
}
}
return(p)
}
screeningGraph(screeningData = screeningFrame,globalCovariate = "No",selCovariate = "age")
selCovariate
screeningData = screeningFrame
ggplot(data = screeningData, aes_string(x = selCovariate, colour = "treatmentArm")) +
geom_density()
ggplot(data = screeningData, aes_string(x = selCovariate)) +
geom_density()
ggplot(data = screeningData, aes_string(x = "age")) +
geom_density()
library(shinydashboard)
library(dplyr)
library(ggplot2)
library(forcats)
library(data.table)
setwd("~/Documents/GitHub/ShinyProgrammingExercise")
PatientLevelInfo = fread("Random_PatientLevelInfo_2020.tsv", stringsAsFactors = T)
LabValuesInfo = fread("Random_LabValuesInfo_2020.tsv", stringsAsFactors = T)
#Cleaning Patient Level Info
#Extract potential region identifier and patient id from USUBJID and put back into table
splitFrame = tstrsplit(PatientLevelInfo$USUBJID,"-")
PatientLevelInfo$region = paste(splitFrame[[2]],splitFrame[[3]], sep = '-')
PatientLevelInfo$patientId = splitFrame[[5]]
#Recode a treatment arm variable to be a single word describing treatment
PatientLevelInfo$ACTARM = recode(PatientLevelInfo$ACTARM,
`A: Drug X` = "drugX",
`B: Placebo` = "placebo",
`C: Combination` = "combination"
)
PatientLevelInfo$ACTARM = forcats::fct_relevel(PatientLevelInfo$ACTARM,"placebo")
#Change the naming scheme of PatientLevelInfo to begin with lowercase and capitalize each subsequent concactenated word
#USUBJID remains the same because we will use it join LabValuesInfo and PatientLevelInfo
names(PatientLevelInfo) = c("studyId","USUBJID","age","sex","race","treatmentArm","actArmCd","region","patientId")
#Drop redundant columns
PatientLevelInfo = PatientLevelInfo %>%
select(-c("actArmCd"))
#Before merging LabValuesInfo to the PatientLevelInfo we
#reconstruct it so that a single row captures the patient's 3 laboratory value measurements at a particular visit
#calculate difference of measurements between visits for each patient
#calculate the difference betwee the last recorded value week 5 and the baseline value
#create a days from baseline variable
#metadata such as the long name of ALT is excluded from the frame but displayed in the application
PatientByVisit = LabValuesInfo %>%
#make screening the first level of ALT
mutate(AVISIT = forcats::fct_relevel(AVISIT,"SCREENING")) %>%
group_by(USUBJID,AVISIT) %>%
#Collect lab values by patient + visit
summarise(ALT = AVAL[which(LBTESTCD == 'ALT')],
CRP = AVAL[which(LBTESTCD == 'CRP')],
IGA = AVAL[which(LBTESTCD == "IGA")],
BMRKR1 = unique(BMRKR1),
BMRKR2 = unique(BMRKR2)) %>%
#I want baseline to be 0 and screening to be negative (before the trial)
mutate(VISIT_NUM = as.numeric(AVISIT) - 2,
diffALT = c(NA,diff(ALT)),
diffCRP = c(NA,diff(CRP)),
diffIGA = c(NA,diff(IGA)),
#-1 is assigned to SCREENING as it occurs before the baseline record.
daysFromBaseline = recode(as.numeric(AVISIT),-1,0,7,14,21,28),
endDiffBaselineALT = ALT[which(VISIT_NUM == 5)] - ALT[which(VISIT_NUM == 0)],
endDiffBaselineCRP = CRP[which(VISIT_NUM == 5)] - CRP[which(VISIT_NUM == 0)],
endDiffBaselineIGA = IGA[which(VISIT_NUM == 5)] - IGA[which(VISIT_NUM == 0)]
) %>%
select(-c("VISIT_NUM","AVISIT"))
names(PatientByVisit) = c("USUBJID","ALT","CRP","IGA","firstBiomarker","secondBiomarker",
"diffALT","diffCRP","diffIGA","daysFromBaseline",
"endDiffBaselineALT","endDiffBaselineCRP","endDiffBaselineIGA")
#Join together the PatientLevelInfo and PatientByVisit (formerly LabValuesInfo) frames
TrialFrame = left_join(PatientLevelInfo,PatientByVisit,by = 'USUBJID') %>%
mutate_if(is.integer,as.numeric)
#Global so that is does not need to perform this operation when selected characteristics change
screeningFrame = TrialFrame %>% filter(daysFromBaseline == -1)
#Need to go back to following naming conventions on the race variable
summary(TrialFrame$race)
screeningGraph = function(screeningData,globalCovariate,selCovariate,graphType){
if(class(screeningData[[selCovariate]]) == 'numeric'){
if(globalCovariate == "Yes"){
p <- ggplot(data = screeningData, aes_string(x = selCovariate, colour = "treatmentArm")) +
geom_density() +
geom_density(aes_string(x = selCovariate, colour = "Overall"))
}else if(globalCovariate == "No"){
p <- ggplot(data = screeningData, aes_string(x = selCovariate, colour = "treatmentArm")) +
geom_density()
}
}else if(class(screeningData[[selCovariate]]) == 'factor'){
if(globalCovariate == "Yes"){
p <- ggplot(data = screeningData, aes_string(x = "treatmentArm",fill = selCovariate)) +
geom_bar(position = 'fill')  +
geom_bar(aes_string(x = "Overall",fill = selCovariate),position='fill')
}else if(globalCovariate == "No"){
p <- ggplot(data = screeningData, aes_string(x = "treatmentArm",fill = selCovariate)) +
geom_bar(position = 'fill')
}
}
return(p)
}
screeningGraph(screeningData = screeningFrame,globalCovariate = "No",selCovariate = "age")
screeningGraph(screeningData = screeningFrame,globalCovariate = "No",selCovariate = "age")
ggplot(data = screeningData, aes_string(x = selCovariate, colour = "treatmentArm")) +
geom_density()
screeningData = screeningFrame
ggplot(data = screeningData, aes_string(x = selCovariate, colour = "treatmentArm")) +
geom_density()
ggplot(data = screeningData, aes_string(x = 'age', colour = "treatmentArm")) +
geom_density()
setwd("~/Documents/GitHub/ShinyProgrammingExercise")
PatientLevelInfo = fread("Random_PatientLevelInfo_2020.tsv", stringsAsFactors = T)
library(shinydashboard)
library(dplyr)
library(ggplot2)
library(forcats)
library(data.table)
PatientLevelInfo = fread("Random_PatientLevelInfo_2020.tsv", stringsAsFactors = T)
LabValuesInfo = fread("Random_LabValuesInfo_2020.tsv", stringsAsFactors = T)
Sys.info()
packrat::init(options = list(external.packages = c("shinydashboard", "dplyr", "ggplot2", "forcats", "data.table")))
shiny::runApp()
sourceDir(path = "appFunction/tab1Functions")
sourceDir = function(path, trace = TRUE,...) {
for (nm in list.files(path, pattern = "\\.[RrSsQq]$")) {
if(trace) cat(nm,":")
source(file.path(path, nm), ...)
if(trace) cat("\n")
}
}
sourceDir(path = "appFunction/tab1Functions")
sourceDir(path = "appFunctions/tab1Functions")
sourceDir(path = "appFunctions/tab2Functions")
sourceDir(path = "appFunctions/tab2Functions")
PatientLevelInfo = fread("Random_PatientLevelInfo_2020.tsv", stringsAsFactors = T)
LabValuesInfo = fread("Random_LabValuesInfo_2020.tsv", stringsAsFactors = T)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
library(shinydashboard)
library(dplyr)
library(ggplot2)
library(forcats)
library(data.table)
library(reshape2)
sourceDir = function(path, trace = TRUE,...) {
for (nm in list.files(path, pattern = "\\.[RrSsQq]$")) {
if(trace) cat(nm,":")
source(file.path(path, nm), ...)
if(trace) cat("\n")
}
}
sourceDir(path = "appFunctions/tab1Functions")
sourceDir(path = "appFunctions/tab2Functions")
PatientLevelInfo = fread("Random_PatientLevelInfo_2020.tsv", stringsAsFactors = T)
LabValuesInfo = fread("Random_LabValuesInfo_2020.tsv", stringsAsFactors = T)
#Cleaning Patient Level Info
#Extract potential region identifier and patient id from USUBJID and put back into table
splitFrame = tstrsplit(PatientLevelInfo$USUBJID,"-")
PatientLevelInfo$region = paste(splitFrame[[2]],splitFrame[[3]], sep = '-')
PatientLevelInfo$patientId = splitFrame[[5]]
#Recode a treatment arm variable to be a single word describing treatment
PatientLevelInfo$ACTARM = recode(PatientLevelInfo$ACTARM,
`A: Drug X` = "drugX",
`B: Placebo` = "placebo",
`C: Combination` = "combination"
)
PatientLevelInfo$ACTARM = fct_relevel(PatientLevelInfo$ACTARM,"placebo")
#Change the naming scheme of PatientLevelInfo to begin with lowercase and capitalize each subsequent concactenated word
#USUBJID remains the same because we will use it join LabValuesInfo and PatientLevelInfo
names(PatientLevelInfo) = c("studyId","USUBJID","age","sex","race","treatmentArm","actArmCd","region","patientId")
#Drop redundant columns
PatientLevelInfo = PatientLevelInfo %>%
select(-c("actArmCd"))
#Before merging LabValuesInfo to the PatientLevelInfo we
#reconstruct it so that a single row captures the patient's 3 laboratory value measurements at a particular visit
#calculate difference of measurements between visits for each patient
#calculate the difference betwee the last recorded value week 5 and the baseline value
#create a days from baseline variable
#metadata such as the long name of ALT is excluded from the frame but displayed in the application
PatientByVisit = LabValuesInfo %>%
#make screening the first level of ALT
mutate(AVISIT = fct_relevel(AVISIT,"SCREENING")) %>%
group_by(USUBJID,AVISIT) %>%
#Collect lab values by patient + visit
summarise(ALT = AVAL[which(LBTESTCD == 'ALT')],
CRP = AVAL[which(LBTESTCD == 'CRP')],
IGA = AVAL[which(LBTESTCD == "IGA")],
BMRKR1 = unique(BMRKR1),
BMRKR2 = unique(BMRKR2)) %>%
#I want baseline to be 0 and screening to be negative (before the trial)
mutate(VISIT_NUM = as.numeric(AVISIT) - 2,
diffALT = c(NA,diff(ALT)),
diffCRP = c(NA,diff(CRP)),
diffIGA = c(NA,diff(IGA)),
#-1 is assigned to SCREENING as it occurs before the baseline record.
daysFromBaseline = recode(as.numeric(AVISIT),-1,0,7,14,21,28),
endDiffBaselineALT = ALT[which(VISIT_NUM == 5)] - ALT[which(VISIT_NUM == 0)],
endDiffBaselineCRP = CRP[which(VISIT_NUM == 5)] - CRP[which(VISIT_NUM == 0)],
endDiffBaselineIGA = IGA[which(VISIT_NUM == 5)] - IGA[which(VISIT_NUM == 0)]
) %>%
select(-c("VISIT_NUM","AVISIT"))
names(PatientByVisit) = c("USUBJID","ALT","CRP","IGA","firstBiomarker","secondBiomarker",
"diffALT","diffCRP","diffIGA","daysFromBaseline",
"endDiffBaselineALT","endDiffBaselineCRP","endDiffBaselineIGA")
#Join together the PatientLevelInfo and PatientByVisit (formerly LabValuesInfo) frames
TrialFrame = left_join(PatientLevelInfo,PatientByVisit,by = 'USUBJID') %>%
mutate_if(is.integer,as.numeric)
#Global Frame for each tab so that it does not need to perform these operations when selected characteristics change
screeningFrame = TrialFrame %>% filter(daysFromBaseline == -1)
noScreenFrame = TrialFrame %>%
filter(daysFromBaseline >= 0) %>%
mutate(daysFromBaseline = as.factor(daysFromBaseline))
#Need to go back to following naming conventions on the race variable
summary(TrialFrame$race)
TrialFrame$sex = recode(TrialFrame$sex,'F' = 'Female',
'M' = 'Male',
'UNDIFFERENTIATED' = 'Undifferentiated'
)
TrialFrame$secondBiomarker = recode(TrialFrame$secondBiomarker, 'LOW' = 'Low',
'MEDIUM' = 'Medium',
'HIGH' = 'High'
)
TrialFrame$secondBiomarker = fct_relevel(TrialFrame$secondBiomarker,"Low","Medium","High")
shiny::runApp()
runApp('~/Downloads/sfo-shiny-server-develop 2/InferenceTree/shiny2VCSQI')
runApp('~/Downloads/sfo-shiny-server-develop 2/InferenceTree/shiny2VCSQI')
runApp('~/Downloads/sfo-shiny-server-develop 2/InferenceTree/shiny2VCSQI')
runApp()
runApp()
runApp()
runApp()
runApp()
library(shinydashboard)
library(dplyr)
library(ggplot2)
library(forcats)
library(data.table)
library(reshape2)
sourceDir = function(path, trace = TRUE,...) {
for (nm in list.files(path, pattern = "\\.[RrSsQq]$")) {
if(trace) cat(nm,":")
source(file.path(path, nm), ...)
if(trace) cat("\n")
}
}
sourceDir(path = "appFunctions/tab1Functions")
sourceDir(path = "appFunctions/tab2Functions")
PatientLevelInfo = fread("Random_PatientLevelInfo_2020.tsv", stringsAsFactors = T)
LabValuesInfo = fread("Random_LabValuesInfo_2020.tsv", stringsAsFactors = T)
#Cleaning Patient Level Info
#Extract potential region identifier and patient id from USUBJID and put back into table
splitFrame = tstrsplit(PatientLevelInfo$USUBJID,"-")
PatientLevelInfo$region = paste(splitFrame[[2]],splitFrame[[3]], sep = '-')
PatientLevelInfo$patientId = splitFrame[[5]]
#Recode a treatment arm variable to be a single word describing treatment
PatientLevelInfo$ACTARM = recode(PatientLevelInfo$ACTARM,
`A: Drug X` = "drugX",
`B: Placebo` = "placebo",
`C: Combination` = "combination"
)
PatientLevelInfo$ACTARM = fct_relevel(PatientLevelInfo$ACTARM,"placebo")
#Change the naming scheme of PatientLevelInfo to begin with lowercase and capitalize each subsequent concactenated word
#USUBJID remains the same because we will use it join LabValuesInfo and PatientLevelInfo
names(PatientLevelInfo) = c("studyId","USUBJID","age","sex","race","treatmentArm","actArmCd","region","patientId")
#Drop redundant columns
PatientLevelInfo = PatientLevelInfo %>%
select(-c("actArmCd"))
#Before merging LabValuesInfo to the PatientLevelInfo we
#reconstruct it so that a single row captures the patient's 3 laboratory value measurements at a particular visit
#calculate difference of measurements between visits for each patient
#calculate the difference betwee the last recorded value week 5 and the baseline value
#create a days from baseline variable
#metadata such as the long name of ALT is excluded from the frame but displayed in the application
PatientByVisit = LabValuesInfo %>%
#make screening the first level of ALT
mutate(AVISIT = fct_relevel(AVISIT,"SCREENING")) %>%
group_by(USUBJID,AVISIT) %>%
#Collect lab values by patient + visit
summarise(ALT = AVAL[which(LBTESTCD == 'ALT')],
CRP = AVAL[which(LBTESTCD == 'CRP')],
IGA = AVAL[which(LBTESTCD == "IGA")],
BMRKR1 = unique(BMRKR1),
BMRKR2 = unique(BMRKR2)) %>%
#I want baseline to be 0 and screening to be negative (before the trial)
mutate(VISIT_NUM = as.numeric(AVISIT) - 2,
diffALT = c(NA,diff(ALT)),
diffCRP = c(NA,diff(CRP)),
diffIGA = c(NA,diff(IGA)),
#-1 is assigned to SCREENING as it occurs before the baseline record.
daysFromBaseline = recode(as.numeric(AVISIT),-1,0,7,14,21,28),
endDiffBaselineALT = ALT[which(VISIT_NUM == 5)] - ALT[which(VISIT_NUM == 0)],
endDiffBaselineCRP = CRP[which(VISIT_NUM == 5)] - CRP[which(VISIT_NUM == 0)],
endDiffBaselineIGA = IGA[which(VISIT_NUM == 5)] - IGA[which(VISIT_NUM == 0)]
) %>%
select(-c("VISIT_NUM","AVISIT"))
names(PatientByVisit) = c("USUBJID","ALT","CRP","IGA","firstBiomarker","secondBiomarker",
"diffALT","diffCRP","diffIGA","daysFromBaseline",
"endDiffBaselineALT","endDiffBaselineCRP","endDiffBaselineIGA")
#Join together the PatientLevelInfo and PatientByVisit (formerly LabValuesInfo) frames
TrialFrame = left_join(PatientLevelInfo,PatientByVisit,by = 'USUBJID') %>%
mutate_if(is.integer,as.numeric)
#Changing the ordering and vlaues of some factor levels to be better formatted
TrialFrame$sex = recode(TrialFrame$sex,'F' = 'Female',
'M' = 'Male',
'UNDIFFERENTIATED' = 'Undifferentiated'
)
TrialFrame$secondBiomarker = recode(TrialFrame$secondBiomarker, 'LOW' = 'Low',
'MEDIUM' = 'Medium',
'HIGH' = 'High'
)
TrialFrame$secondBiomarker = fct_relevel(TrialFrame$secondBiomarker,"Low","Medium","High")
#Global Frame for each tab so that it does not need to perform these operations when selected characteristics change
screeningFrame = TrialFrame %>% filter(daysFromBaseline == -1)
noScreenFrame = TrialFrame %>%
filter(daysFromBaseline >= 0) %>%
mutate(daysFromBaseline = as.factor(daysFromBaseline))
PatientLevelInfo = fread("Random_PatientLevelInfo_2020.tsv", stringsAsFactors = T)
LabValuesInfo = fread("Random_LabValuesInfo_2020.tsv", stringsAsFactors = T)
splitFrame = tstrsplit(PatientLevelInfo$USUBJID,"-")
PatientLevelInfo$region = paste(splitFrame[[2]],splitFrame[[3]], sep = '-')
PatientLevelInfo$patientId = splitFrame[[5]]
PatientLevelInfo$ACTARM = recode(PatientLevelInfo$ACTARM,
`A: Drug X` = "drugX",
`B: Placebo` = "placebo",
`C: Combination` = "combination"
)
PatientLevelInfo$ACTARM = fct_relevel(PatientLevelInfo$ACTARM,"placebo")
names(PatientLevelInfo) = c("studyId","USUBJID","age","sex","race","treatmentArm","actArmCd","region","patientId")
PatientLevelInfo = PatientLevelInfo %>%
select(-c("actArmCd"))
PatientByVisit = LabValuesInfo %>%
#make screening the first level of ALT
mutate(AVISIT = fct_relevel(AVISIT,"SCREENING")) %>%
group_by(USUBJID,AVISIT) %>%
#Collect lab values by patient + visit
summarise(ALT = AVAL[which(LBTESTCD == 'ALT')],
CRP = AVAL[which(LBTESTCD == 'CRP')],
IGA = AVAL[which(LBTESTCD == "IGA")],
BMRKR1 = unique(BMRKR1),
BMRKR2 = unique(BMRKR2)) %>%
#I want baseline to be 0 and screening to be negative (before the trial)
mutate(VISIT_NUM = as.numeric(AVISIT) - 2,
diffALT = c(NA,diff(ALT)),
diffCRP = c(NA,diff(CRP)),
diffIGA = c(NA,diff(IGA)),
#-1 is assigned to SCREENING as it occurs before the baseline record.
daysFromBaseline = recode(as.numeric(AVISIT),-1,0,7,14,21,28),
endDiffBaselineALT = ALT[which(VISIT_NUM == 5)] - ALT[which(VISIT_NUM == 0)],
endDiffBaselineCRP = CRP[which(VISIT_NUM == 5)] - CRP[which(VISIT_NUM == 0)],
endDiffBaselineIGA = IGA[which(VISIT_NUM == 5)] - IGA[which(VISIT_NUM == 0)]
) %>%
select(-c("VISIT_NUM","AVISIT"))
shiny::runApp()
runApp()
screeningTable = function(screeningData = screeningFrame,globalCovariate,selCovariate){
if(class(screeningData[[selCovariate]]) == 'numeric'){
selCovariate = rlang::sym(selCovariate)
if(globalCovariate == "Yes"){
byArmSummary = screeningFrame %>%
group_by(treatmentArm) %>%
summarise('Mean' = mean(!!selCovariate),
'Standard Deviation' = sd(!!selCovariate),
'Median' = median(!!selCovariate),
'Minimum' = min(!!selCovariate),
'Maximum' = max(!!selCovariate),
'Total Patients' = n()
) %>%
mutate_if(is.numeric,function(x){round(x,2)})
overallSummary = screeningFrame %>%
summarise('treatmentArm' = 'Overall',
'Mean' = mean(!!selCovariate),
'Standard Deviation' = sd(!!selCovariate),
'Median' = median(!!selCovariate),
'Minimum' = min(!!selCovariate),
'Maximum' = max(!!selCovariate),
'Total Patients' = n()
) %>%
mutate_if(is.numeric,function(x){round(x,2)})
screenTable = rbind(overallSummary,byArmSummary)
}else if(globalCovariate == "No"){
screenTable = screeningFrame %>%
group_by(treatmentArm) %>%
summarise('Mean' = mean(!!selCovariate),
'Standard Deviation' = sd(!!selCovariate),
'Median' = median(!!selCovariate),
'Minimum' = min(!!selCovariate),
'Maximum' = max(!!selCovariate),
'Total Patients' = n()
) %>%
mutate_if(is.numeric,function(x){round(x,2)})
}
}else if(class(screeningData[[selCovariate]]) == 'factor'){
if(globalCovariate == "Yes"){
byArmTable = round(prop.table(margin = 1, table(screeningFrame[['treatmentArm']],screeningFrame[[selCovariate]])),3)
overallTable = round(prop.table(table(screeningFrame[[selCovariate]])),3)
screenTable = rbind(byArmTable,overallTable)
}else if(globalCovariate == "No"){
screenTable = round(prop.table(margin = 1,table(screeningFrame[['treatmentArm']],screeningFrame[[selCovariate]])),3)
}
}
return(screenTable)
}
runApp()
packrat::init()
packrat::on()
shiny::runApp('~/Desktop/programmingExercise')
packrat::on()
packrat::on()
packrat::on()
install.packages('data.table')
packrat::on()
packrat::init()
packrat::on()
